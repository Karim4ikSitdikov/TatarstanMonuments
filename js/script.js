document.addEventListener('DOMContentLoaded', function() {
    ymaps.ready(initMap);
    
    // Обработка формы добавления памятника
    const form = document.getElementById('monument-form');
    if (form) {
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            alert('Спасибо! Ваша заявка принята. После проверки модератором памятник будет добавлен на карту.');
            form.reset();
        });
    }
});

function initMap() {
    // Создаем карту с центром в Татарстане
    const map = new ymaps.Map('map', {
        center: [55.3, 51.5], // Центр Татарстана
        zoom: 8,
        controls: ['zoomControl', 'typeSelector', 'fullscreenControl']
    });

    // Стиль для меток
    const monumentStyle = {
        preset: 'islands#redIcon',
        iconColor: '#e30613'
    };

    // Добавляем памятники (можно заменить на загрузку из JSON)
    const monuments = [
        {
        name: "«Воинам, павшим в годы Великой Отечественной войны»",
        description: "Памятник воинам-землякам",
        address: "Лениногорский район, с. Тимяшево",
        coords: [54.596944, 52.476944]
    },
    {
        name: "«Воинам, павшим в годы Великой Отечественной войны»",
        description: "Памятник воинам-землякам",
        address: "Чистопольский район, с. Каргали",
        coords: [55.363611, 50.642778]
    },
    {
        name: "Обелиск воинам-землякам",
        description: "Обелиск посвящен воинам, отдавшим свои жизни за наши мечты",
        address: "Сергиевский район, с. Верхняя Орлянка",
        coords: [53.933333, 51.25]
    },
    {
        name: "Героям Великой Отечественной войны",
        description: "Памятник героям ВОВ",
        address: "Клявлинский район, ст. Клявлино",
        coords: [54.166667, 52.033333]
    },
    {
        name: "Памятник павшим воинам - усмановцам",
        description: "Памятник землякам, погибшим в годы ВОВ",
        address: "Камышлинский район, с. Новое Усманово",
        coords: [54.716667, 54.116667]
    },
    {
        name: "Стелла односельчанам, погибшим в годы Великой Отечественной войны",
        description: "Обелиск посвящен односельчанам, павшим на полях сражений в годы Великой Отечественной войны",
        address: "Муслюмовский район, с. Тойгильдино",
        coords: [55.316667, 53.183333]
    },
    {
        name: "Мемориал «Вечный огонь»",
        description: "Мемориальный комплекс с круговым изображением лиц защитников Отечества и 12-метровой стелой",
        address: "Азнакаевский район, г. Азнакаево, ул.Ленина, Площадь Победы",
        coords: [54.853889, 53.098611]
    },
    {
        name: "Мемориальный комплекс «Вечный огонь»",
        description: "Комплекс посвящён павшим в годы ВОВ 1941–1945 годов. Включает монумент со скульптурой воина",
        address: "г.Альметьевск, ул. Тимирязева, 50",
        coords: [54.898785, 52.299951]
    },
    {
        name: "Памятник солдату-освободителю",
        description: "Солдат-освободитель на постаменте с табличками погибших и вернувшихся с войны",
        address: "Муслюмовский район, с. Ташлияр",
        coords: [55.260477, 52.941246]
    },
    {
        name: "Стелла погибшим в ВОВ 1941-1945гг.",
        description: "Две памятные плиты с именами погибших в годы войны",
        address: "Актанышский район, с.Масады, ул.Агыйдел",
        coords: [55.836125, 53.831337]
    },
    {
        name: "Стелла погибшим в ВОВ 1941-1945гг.",
        description: "Кирпичная стелла с каменными табличками с именами погибших",
        address: "Актанышский район, с. Барсуково, ул.Куйбышева",
        coords: [55.813177, 53.850471]
    },
    {
        name: "Мемориальный комплекс «Родина-мать»",
        description: "Состоит из вечного огня, скульптуры и стены с именами погибших",
        address: "г.Набережные Челны",
        coords: [55.6894, 52.305]
    },
    {
        name: "Стелла ветеранам, тыловикам и погибшим в ВОВ",
        description: "Две гранитные плиты с именами погибших и вернувшихся",
        address: "Тукаевский район, с. Иштеряково, ул. Центральная 232",
        coords: [55.534156, 51.940945]
    },
    {
        name: "Мемориал Великой Отечественной войны",
        description: "Комплекс включает стеллу, «вечный огонь», танк на постаменте",
        address: "Альметьевский район, с. Русский Акташ",
        coords: [55.04456, 52.11558]
    },
    {
        name: "Памятник Бисерянам, погибшим в годы ВОВ",
        description: "Памятник землякам, погибшим на фронтах войны",
        address: "Пермский край, р.п. Бисер, ул. Советская, 23",
        coords: [58.383333, 59.05]
    },
    {
        name: "Обелиск односельчанам, павшим на фронтах ВОВ",
        description: "Памятник воинам-землякам",
        address: "Пермский край, д. Осенцы, ул. Ермашевская",
        coords: [58.6, 56.383333]
    },
    {
        name: "Металлургам, погибшим в годы ВОВ",
        description: "Памятник работникам металлургической промышленности",
        address: "Свердловская обл., г. Нижняя Тура",
        coords: [58.620833, 59.847778]
    },
    {
        name: "Воинам-односельчанам, погибшим в годы ВОВ",
        description: "Памятник землякам, не вернувшимся с войны",
        address: "Пермский край, с. Култаево",
        coords: [57.916667, 56.483333]
    },
    {
        name: "Памятники в честь Победы в ВОВ",
        description: "Мемориалы на автодороге Кунгур-Соликамск",
        address: "Пермский край, г. Лысьва",
        coords: [58.1, 57.8]
    },
    {
        name: "Мемориал Великой Отечественной войны",
        description: "Памятник воинам-землякам",
        address: "Пермский край, п. Сылва, ул. Мичурина",
        coords: [57.9, 56.3]
    },
    {
        name: "Мемориал Великой Отечественной войны",
        description: "Памятник героям войны",
        address: "Пермский край, г. Оса, ул. Свердлова",
        coords: [57.283333, 55.45]
    },
    {
        name: "Мемориал героям-землякам",
        description: "Памятник воинам-землякам",
        address: "Пермский край, с.Троица",
        coords: [57.983333, 56.466667]
    },
    {
        name: "Памятник, мемориал",
        description: "Памятник воинам-землякам",
        address: "Пермский край, с. Уральское",
        coords: [56.766667, 54.316667]
    },
    {
        name: "Неизвестный Солдат",
        description: "Памятник неизвестному солдату",
        address: "Пермский край, г. Горнозаводск, Городской парк",
        coords: [58.383333, 58.316667]
    },
    {
        name: "Памятник, посвященный ВОВ",
        description: "Памятник героям войны",
        address: "Пермский край, пгт Полазна",
        coords: [58.3, 56.416667]
    },
    {
        name: "Обелиск в честь земляков, погибших в ВОВ",
        description: "Обелиск установлен в исчезнувшей деревне Гыркеснюк",
        address: "Удмуртия, Дебесский район, д. Гыркеснюк",
        coords: [57.65, 53.816667]
    },
    {
        name: "Обелиск погибшим землякам в ВОВ",
        description: "Памятник воинам-землякам",
        address: "Пермский край, с. Тараканово",
        coords: [57.666667, 54.6]
    },
    {
        name: "Памятник землякам, погибшим в ВОВ",
        description: "Памятник воинам-землякам",
        address: "Удмуртия, д. Мукши",
        coords: [57.183333, 53.166667]
    },
    {
        name: "Монумент боевой и трудовой славы",
        description: "Комплекс включает статую воина, Вечный огонь и стелы с именами погибших",
        address: "г. Ижевск, Карлутская площадь",
        coords: [56.852778, 53.211389]
    },
    {
        name: "Памятник «Родина-мать»",
        description: "Памятник защитникам Отечества",
        address: "Удмуртия, с. Селты",
        coords: [57.316667, 52.133333]
    },
    {
        name: "Мемориал «Землякам — защитникам Отечества»",
        description: "Мемориал с Вечным огнём",
        address: "Удмуртия, с. Малая Пурга",
        coords: [56.55, 53]
    },
    {
        name: "Мемориал «Они сражались за Родину»",
        description: "Композиция: солдат выносит раненого товарища и молящаяся женщина",
        address: "Удмуртия, с. Сюмси",
        coords: [57.116667, 51.616667]
    },
    {
        name: "Памятник героям, павшим в боях за Родину",
        description: "Памятник воинам-землякам",
        address: "Лаишевский район, с. Песчаные Ковали",
        coords: [55.622271, 49.148482]
    },
    {
        name: "Памятник «Сынам Отечества»",
        description: "Памятник защитникам Родины",
        address: "Буинский район, с.Старый Студенец",
        coords: [54.966667, 48.233333]
    },
    {
        name: "Памятник «Воинам, павшим в годы ВОВ»",
        description: "Памятник защитникам Отечества",
        address: "Чувашия, п.Конар, ул. Школьная",
        coords: [55.5, 47.5]
    },
    {
        name: "Памятник «Воинам, павшим в годы ВОВ»",
        description: "Памятник защитникам Отечества",
        address: "Кировская обл., с.Лазарево",
        coords: [57.116667, 50.033333]
    },
    {
        name: "Мемориал памяти Героям ВОВ",
        description: "Мемориал в Парке Победы",
        address: "г. Казань, Парк Победы",
        coords: [55.8, 49.2]
    },
    {
        name: "Мемориал",
        description: "Памятник защитникам Отечества",
        address: "Кировская обл., с.Шурма, ул. Советская",
        coords: [57.383333, 50.016667]
    },
    {
        name: "Мемориал «Воинам-землякам»",
        description: "Памятник установлен к 30-летию Победы воинам-большесосновцам",
        address: "Пермский край, с. Большая Соснова",
        coords: [57.666667, 54.6]
    },
    {
        name: "Мемориал погибшим в ВОВ",
        description: "Памятник воинам-землякам",
        address: "Удмуртия, с. Якшур-Бодья",
        coords: [57.183333, 53.166667]
    },
    {
        name: "Памятник погибшим в ВОВ 1941-1945гг.",
        description: "Каменный обелиск с именами погибших",
        address: "Тукаевский район, д.Авлаш",
        coords: [55.544265, 52.011018]
    },
    {
        name: "Воинам-землякам, павшим в ВОВ",
        description: "Памятник защитникам Отечества",
        address: "Свердловская обл., п. Платина, ул. Пионерская",
        coords: [58.620833, 59.847778]
    },
    {
        name: "Памятник",
        description: "Памятник в микрорайоне Урсала",
        address: "Альметьевск мкр. Урсала ул. Советская",
        coords: [54.93314, 52.366522]
    },
    {
        name: "Памятник",
        description: "Памятник в микрорайоне Бигаш",
        address: "Альметьевск мкр Бигаш",
        coords: [54.915185, 52.290331]
    },
    {
        name: "Аллея героев",
        description: "Аллея героев в городском парке",
        address: "Альметьевск, Городской парк имени 60-летия нефти Татарстана",
        coords: [54.898002, 52.301075]
    }
    ];

    // Создаем коллекцию меток
    const monumentCollection = new ymaps.GeoObjectCollection(null, {
        preset: 'islands#redIcon'
    });

    // Добавляем метки на карту
    monuments.forEach(monument => {
        const placemark = new ymaps.Placemark(
            monument.coords,
            {
                balloonContentHeader: monument.name,
                balloonContentBody: `
                    <div class="balloon">
                        <h3>${monument.name}</h3>
                        ${monument.photo ? `<img src="${monument.photo}" alt="${monument.name}" style="max-width:250px;">` : ''}
                        <p><strong>Адрес:</strong> ${monument.address}</p>
                        <p>${monument.description}</p>
                    </div>
                `,
                hintContent: monument.name
            },
            monumentStyle
        );
        monumentCollection.add(placemark);
    });

    map.geoObjects.add(monumentCollection);

    // Устанавливаем границы для показа всех памятников
    if (monuments.length > 0) {
        map.setBounds(monumentCollection.getBounds(), {
            checkZoomRange: true,
            zoomMargin: 50
        });
    }
}
